<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS 多账号控制面板</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <div class="container">
        <header class="page-header">
            <div>
                <h1>AWS 多账号控制面板</h1>
                <p>本地保存多账号配置，便捷生成控制台登录链接并管理实例。</p>
            </div>
        </header>

        <section class="card">
            <div class="card-header">
                <h2>配置管理</h2>
            </div>
            <div class="card-body grid grid-2">
                <div class="form-group">
                    <label for="profile-select">当前配置</label>
                    <select id="profile-select"></select>
                </div>
                <div class="form-group">
                    <label for="profile-name-input">配置名称</label>
                    <input type="text" id="profile-name-input" placeholder="如：账号A-东京">
                </div>
                <div class="button-group">
                    <button id="new-profile">新建配置</button>
                    <button id="rename-profile">重命名</button>
                    <button id="delete-profile" class="danger">删除</button>
                    <button id="save-profile" class="primary">保存/覆盖</button>
                </div>
                <div class="proxy-status" id="profile-result">配置操作结果将在此显示</div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <h2>凭证 &amp; 网络</h2>
            </div>
            <div class="card-body grid grid-2">
                <div class="form-group">
                    <label for="access-key">Access Key ID</label>
                    <input type="text" id="access-key" placeholder="AKIA...">
                </div>
                <div class="form-group">
                    <label for="secret-key">Secret Access Key</label>
                    <input type="password" id="secret-key" placeholder="********">
                </div>
                <div class="form-group">
                    <label for="region">Region</label>
                    <select id="region"></select>
                </div>
                <div class="form-group">
                    <label for="session-duration">会话时长（秒）</label>
                    <input type="number" id="session-duration" value="3600" min="900" max="43200">
                </div>
                <div class="button-group">
                    <button id="test-aws">测试 AWS 账号</button>
                    <button id="generate-link" class="primary">生成登录链接</button>
                    <button id="fetch-quota">查看 Spot 配额</button>
                </div>
                <div class="proxy-status" id="aws-result">AWS 账号测试结果将在此显示</div>
                <div class="proxy-status" id="quota-result">Spot 配额状态将在此显示</div>
            </div>
        </section>

        <section class="card">
            <div class="card-header">
                <h2>临时控制台链接</h2>
            </div>
            <div class="card-body">
                <div class="button-group">
                    <a id="open-console" class="button primary" href="#" target="_blank" rel="noopener">打开 AWS 控制台</a>
                    <button id="copy-link">复制链接</button>
                </div>
                <p id="console-url" class="mono url-text">尚未生成，请先提交</p>
                <div class="proxy-status" id="link-result">临时登录链接状态将在此显示</div>
            </div>
        </section>

        <section class="card">
            <div class="card-header flex-between">
                <h2>实例创建</h2>
            </div>
            <div class="card-body grid grid-2">
                <div class="form-group">
                    <label for="create-type">实例类型</label>
                    <select id="create-type">
                        <option value="ec2">EC2</option>
                        <option value="lightsail">Lightsail</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="create-name">实例名称（Lightsail 必填）</label>
                    <input type="text" id="create-name" placeholder="如：demo-server">
                </div>
                <div class="form-group">
                    <label for="create-region">创建区域</label>
                    <select id="create-region"></select>
                </div>
                <div class="form-group">
                    <label for="create-arch">架构</label>
                    <select id="create-arch">
                        <option value="x86_64">x86_64</option>
                        <option value="arm64">arm64</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="create-instance-type">规格/型号</label>
                    <select id="create-instance-type"></select>
                </div>
                <div class="form-group">
                    <label for="create-ami">EC2 镜像（AMI/SSM 参数）</label>
                    <select id="create-ami"></select>
                </div>
                <div class="form-group">
                    <label for="create-bundle">Lightsail 套餐</label>
                    <select id="create-bundle"></select>
                </div>
                <div class="form-group">
                    <label for="create-blueprint">Lightsail 镜像</label>
                    <select id="create-blueprint"></select>
                </div>
                <div class="form-group">
                    <label for="create-password">自定义密码（可选，自动根据镜像生成脚本）</label>
                    <input type="text" id="create-password" placeholder="例如 112233aabbCC">
                </div>
                <div class="form-group">
                    <label for="create-volume">EC2 磁盘大小（GiB）</label>
                    <input type="number" id="create-volume" value="20" min="8" step="1">
                </div>
                <div class="button-group">
                    <button id="create-instance-btn" class="primary">创建实例（开放所有端口）</button>
                </div>
                <div class="proxy-status" id="create-result">实例创建状态将在此显示</div>
            </div>
        </section>

        <section class="card">
            <div class="card-header flex-between">
                <h2>批量删除账户下所有 EC2</h2>
            </div>
            <div class="card-body grid grid-2">
                <div class="form-group full-span">
                    <label for="batch-accounts">账号列表（每行：可选名称 AccessKey SecretKey）</label>
                    <textarea id="batch-accounts" rows="6" placeholder="示例：&#10;acct1 AKIA... SECRET...&#10;AKIA... SECRET..."></textarea>
                </div>
                <div class="form-group full-span">
                    <label for="batch-result">操作结果</label>
                    <pre id="batch-result" class="batch-result"></pre>
                </div>
                <div class="button-group">
                    <button id="batch-delete" class="danger">批量删除 EC2</button>
                </div>
            </div>
        </section>

        <section class="card">
            <div class="card-header flex-between">
                <h2>实例管理</h2>
                <div class="button-group">
                    <select id="manage-region"></select>
                    <button id="load-instances" class="primary">加载实例</button>
                </div>
            </div>
            <div class="card-body">
                <p class="muted">当前配置：<span id="current-profile-name">-</span> ｜ Region：<span id="current-region">-</span></p>
                <div class="proxy-status" id="instances-result">实例加载状态将在此显示</div>

                <h3>EC2</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>InstanceId</th>
                                <th>Name</th>
                                <th>状态</th>
                                <th>公网 IP</th>
                                <th>内网 IP</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="ec2-table-body"></tbody>
                    </table>
                </div>

                <h3>Lightsail</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>状态</th>
                                <th>公网 IP</th>
                                <th>内网 IP</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="lightsail-table-body"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </div>

    <div id="toast" class="toast hidden"></div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
